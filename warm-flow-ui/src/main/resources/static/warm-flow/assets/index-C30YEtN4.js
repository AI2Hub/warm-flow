import{r,C as ee,J as te,d as i,G as le,o as d,c as z,H as k,I as B,h as t,e as l,f as a,k as oe,K as ae,L as ne,l as _,p as m,z as $,m as q,n as x,D as se,bN as F,B as re,v as ie,bU as ue,bS as pe}from"./index-CHQH9-TC.js";import{a as de}from"./execute-Dmqi2dJm.js";import{j as ce}from"./definition-CAAY_8pD.js";const me={class:"app-container"},fe=["src"],_e=re({name:"Done"}),he=Object.assign(_e,{setup(ve){const{proxy:N}=ie(),{flow_status:I,cooperate_type:R}=N.useDict("flow_status","cooperate_type");r([]);const E=r(!0),C=r(""),v=r(!1),b=r(0),S=r([]);r(null);const K=ee({queryParams:{pageNum:1,pageSize:10,nodeName:null,flowStatus:null,createBy:null,createTime:null}}),w=r(null),L=r(null),O=r(!1),h=r(null),y=r(null),D=r(null),{queryParams:s}=te(K);function g(){de(s.value).then(n=>{S.value=n.rows,b.value=n.total})}function V(){s.value.pageNum=1,g()}function Y(){N.resetForm("queryForm"),V()}function H(n,o,p){const c={disabled:!1,pageNum:s.value.pageNum,formPath:o,testLeaveVo:p};ue.push({path:`/done/doneList/index/${n}`,query:c})}function J(n){ce(n).then(o=>{v.value=!0,C.value="data:image/gif;base64,"+o.data})}function j(n){if(y.value=n.id,D.value=n.businessId,n.ext)try{const p=JSON.parse(n.ext);h.value={...p}}catch{console.error("Invalid ext JSON format:",n.ext)}const o=n.formPath;o?pe(()=>import(`../../../../views/${o}`),__vite__mapDeps([])).then(p=>{w.value=p.default}):w.value=null}return g(),(n,o)=>{const p=i("el-input"),c=i("el-form-item"),M=i("el-option"),Q=i("el-select"),A=i("el-date-picker"),f=i("el-button"),G=i("el-form"),u=i("el-table-column"),P=i("dict-tag"),W=i("el-table"),X=i("pagination"),T=i("el-dialog"),Z=le("hasPermi");return d(),z("div",me,[k(l(G,{model:t(s),ref:"queryForm",inline:!0,"label-width":"100px"},{default:a(()=>[l(c,{label:"任务名称",prop:"nodeName"},{default:a(()=>[l(p,{modelValue:t(s).nodeName,"onUpdate:modelValue":o[0]||(o[0]=e=>t(s).nodeName=e),placeholder:"请输入任务名称",clearable:"",onKeyup:oe(V,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),l(c,{label:"流程状态",prop:"flowStatus"},{default:a(()=>[l(Q,{modelValue:t(s).flowStatus,"onUpdate:modelValue":o[1]||(o[1]=e=>t(s).flowStatus=e),placeholder:"请选择流程状态",clearable:""},{default:a(()=>[(d(!0),z(ae,null,ne(t(I),e=>(d(),_(M,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(c,{label:"审批时间",prop:"createTime"},{default:a(()=>[l(A,{clearable:"",modelValue:t(s).createTime,"onUpdate:modelValue":o[2]||(o[2]=e=>t(s).createTime=e),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"选择创建时间"},null,8,["modelValue"])]),_:1}),l(c,null,{default:a(()=>[l(f,{type:"primary",icon:"Search",onClick:V},{default:a(()=>[m("搜索")]),_:1}),l(f,{icon:"Refresh",onClick:Y},{default:a(()=>[m("重置")]),_:1})]),_:1})]),_:1},8,["model"]),[[B,t(E)]]),l(W,{data:t(S)},{default:a(()=>[l(u,{type:"selection",width:"55",align:"center",fixed:""}),l(u,{label:"序号",width:"55",align:"center"},{default:a(e=>[m($(e.$index+1),1)]),_:1}),l(u,{label:"流程实例id",align:"center",prop:"instanceId","show-overflow-tooltip":!0}),l(u,{label:"流程名称",align:"center",prop:"flowName","show-overflow-tooltip":!0}),l(u,{label:"任务名称",align:"center",prop:"targetNodeName","show-overflow-tooltip":!0}),l(u,{label:"审批人",align:"center",prop:"approver","show-overflow-tooltip":!0}),l(u,{label:"协作类型",align:"center",prop:"cooperateType","show-overflow-tooltip":!0},{default:a(e=>[l(P,{options:t(R),value:e.row.cooperateType},null,8,["options","value"])]),_:1}),l(u,{label:"协作人",align:"center",prop:"collaborator","show-overflow-tooltip":!0}),l(u,{label:"流程状态",align:"center",prop:"flowStatus","show-overflow-tooltip":!0},{default:a(e=>[l(P,{options:t(I),value:e.row.flowStatus},null,8,["options","value"])]),_:1}),l(u,{label:"审批时间",align:"center",prop:"createTime",width:"160","show-overflow-tooltip":!0},{default:a(e=>[q("span",null,$(n.parseTime(e.row.createTime)),1)]),_:1}),l(u,{label:"操作",align:"center",width:"110",fixed:"right","class-name":"small-padding fixed-width"},{default:a(e=>[k((d(),_(f,{size:"small",type:"text",onClick:U=>H(e.row.instanceId,e.row.formPath,e.row.testLeaveVo)},{default:a(()=>[m("审批记录")]),_:2},1032,["onClick"])),[[Z,["flow:execute:doneList"]]]),l(f,{size:"small",type:"text",onClick:U=>J(e.row.instanceId)},{default:a(()=>[m("流程图")]),_:2},1032,["onClick"]),e.row.ext?(d(),_(f,{key:0,size:"small",type:"text",onClick:U=>j(e.row)},{default:a(()=>[m("查看")]),_:2},1032,["onClick"])):x("",!0)]),_:1})]),_:1},8,["data"]),k(l(X,{total:t(b),page:t(s).pageNum,"onUpdate:page":o[3]||(o[3]=e=>t(s).pageNum=e),limit:t(s).pageSize,"onUpdate:limit":o[4]||(o[4]=e=>t(s).pageSize=e),onPagination:g},null,8,["total","page","limit"]),[[B,t(b)>0]]),l(T,{title:"流程图",modelValue:t(v),"onUpdate:modelValue":o[5]||(o[5]=e=>se(v)?v.value=e:null),width:"80%"},{default:a(()=>[q("img",{src:t(C),width:"1000",style:{margin:"0 auto"}},null,8,fe)]),_:1},8,["modelValue"]),t(w)?(d(),_(F(t(w)),{key:0,businessId:t(D),taskId:t(y),testLeaveVo:t(h),onRefresh:g},null,40,["businessId","taskId","testLeaveVo"])):x("",!0),l(T,{title:"审批详情",visible:t(O),width:"80%"},{default:a(()=>[t(L)?(d(),_(F(t(L)),{key:0,testLeaveVo:t(h),taskId:t(y),disabled:!1},null,8,["testLeaveVo","taskId"])):x("",!0)]),_:1},8,["visible"])])}}});export{he as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}