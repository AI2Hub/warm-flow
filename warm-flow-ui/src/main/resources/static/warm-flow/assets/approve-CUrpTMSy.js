import{g as Z,h as ee}from"./leave-Cz5vLoQ-.js";import{e as le}from"./execute-Dmqi2dJm.js";import{r as c,C as te,J as ae,d as s,o as u,c as i,h as t,l as r,bO as oe,f as l,m as ne,e as a,p as C,z as g,K as R,L as Y,D as N,n as x,B as ue,v as se}from"./index-CHQH9-TC.js";const de={class:"app-container"},re={key:0},me={key:0},ie={key:0},pe={key:0},fe={key:0},ce={class:"dialog-footer"},ve=ue({name:"Approve"}),be=Object.assign(ve,{props:{modelValue:{type:String,default:""},taskId:{type:String,default:""},disabled:{type:Boolean,default:!1},testLeaveVo:{type:Object,default:()=>({})}},emits:["refresh"],setup(d,{emit:D}){const{proxy:_}=se(),{flow_status:ye,leave_type:S}=_.useDict("flow_status","leave_type"),b=d,p=c(!1),A=c(""),I=c(!1),F=c([]),k=c(""),V=c(""),q=te({form:{},rules:{type:[{required:!0,message:"请假类型不能为空",trigger:"change"}],reason:[{required:!0,message:"请假原因不能为空",trigger:"blur"}],startTime:[{required:!0,message:"开始时间不能为空",trigger:"blur"}],endTime:[{required:!0,message:"结束时间不能为空",trigger:"blur"}],day:[{required:!0,message:"请假天数不能为空",trigger:"blur"}]}}),w=c(!0),{form:n,rules:z}=ae(q),$=D;function H(){B(),testLeaveVo.value&&Object.keys(testLeaveVo.value).length?(n.value={...n.value,...testLeaveVo.value},w.value=!1):Z(b.modelValue).then(f=>{f.data||_.$modal.alertWarning("待办任务不存在"),n.value=f.data,le(n.value.instanceId,n.value.nodeCode).then(e=>{e.code===200&&e.data!==null&&e.data!==void 0&&(b.showAnyNode=!0,b.anyNode=e.data)})}),A.value="办理",p.value=!0}function M(){p.value=!1,B()}function B(){n.value={message:null,id:null,tenantId:null,type:null,reason:null,startTime:null,endTime:null,day:null,instanceId:null,nodeCode:null,nodeName:null,flowStatus:null,createBy:null,createTime:null,updateBy:null,updateTime:null,delFlag:null},V.value="",_.resetForm("leaveApproveRef")}function O(f){_.$refs.leaveApproveRef.validate(e=>{e&&ee(n.value,b.taskId,f,n.value.message,k.value,V.value).then(()=>{_.$modal.msgSuccess("办理成功"),p.value=!1,$("refresh")})})}function E(f){const e=S.value.find(L=>L.value===f);return e?e.label:""}return H(),(f,e)=>{const L=s("el-option"),U=s("el-select"),m=s("el-form-item"),v=s("el-col"),y=s("el-row"),h=s("el-input"),j=s("el-date-picker"),W=s("el-input-number"),J=s("WarningFilled"),K=s("el-icon"),P=s("el-tooltip"),G=s("el-divider"),Q=s("el-form"),T=s("el-button"),X=s("el-dialog");return u(),i("div",de,[t(p)?(u(),r(X,{key:0,title:t(A),modelValue:t(p),"onUpdate:modelValue":e[10]||(e[10]=o=>N(p)?p.value=o:null),width:"800px","append-to-body":""},oe({default:l(()=>[a(Q,{ref:"leaveApproveRef",model:t(n),rules:t(z),"label-width":"110px",disabled:d.disabled},{default:l(()=>[a(y,null,{default:l(()=>[a(v,{span:12},{default:l(()=>[a(m,{label:"请假类型",prop:"type"},{default:l(()=>[d.testLeaveVo&&Object.keys(d.testLeaveVo).length?(u(),i("div",re,g(E(t(n).type)),1)):(u(),r(U,{key:1,modelValue:t(n).type,"onUpdate:modelValue":e[0]||(e[0]=o=>t(n).type=o),placeholder:"请选择请假类型"},{default:l(()=>[(u(!0),i(R,null,Y(t(S),o=>(u(),r(L,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]))]),_:1})]),_:1})]),_:1}),a(y,null,{default:l(()=>[a(v,{span:24},{default:l(()=>[a(m,{label:"请假原因",prop:"reason"},{default:l(()=>[d.testLeaveVo&&Object.keys(d.testLeaveVo).length?(u(),i("div",me,g(t(n).reason),1)):(u(),r(h,{key:1,modelValue:t(n).reason,"onUpdate:modelValue":e[1]||(e[1]=o=>t(n).reason=o),type:"textarea",placeholder:"请输入内容"},null,8,["modelValue"]))]),_:1})]),_:1})]),_:1}),a(y,null,{default:l(()=>[a(v,{span:12},{default:l(()=>[a(m,{label:"开始时间",prop:"startTime"},{default:l(()=>[d.testLeaveVo&&Object.keys(d.testLeaveVo).length?(u(),i("div",ie,g(t(n).startTime),1)):(u(),r(j,{key:1,clearable:"",size:"small",modelValue:t(n).startTime,"onUpdate:modelValue":e[2]||(e[2]=o=>t(n).startTime=o),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"选择开始时间"},null,8,["modelValue"]))]),_:1})]),_:1}),a(v,{span:12},{default:l(()=>[a(m,{label:"结束时间",prop:"endTime"},{default:l(()=>[d.testLeaveVo&&Object.keys(d.testLeaveVo).length?(u(),i("div",pe,g(t(n).endTime),1)):(u(),r(j,{key:1,clearable:"",size:"small",modelValue:t(n).endTime,"onUpdate:modelValue":e[3]||(e[3]=o=>t(n).endTime=o),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"选择结束时间"},null,8,["modelValue"]))]),_:1})]),_:1})]),_:1}),a(y,null,{default:l(()=>[a(v,{span:12},{default:l(()=>[a(m,{label:"请假天数",prop:"day"},{default:l(()=>[d.testLeaveVo&&Object.keys(d.testLeaveVo).length?(u(),i("div",fe,g(t(n).day),1)):(u(),r(W,{key:1,modelValue:t(n).day,"onUpdate:modelValue":e[4]||(e[4]=o=>t(n).day=o),placeholder:"请输入请假天数","controls-position":"right",min:0},null,8,["modelValue"]))]),_:1})]),_:1})]),_:1}),a(y,null,{default:l(()=>[a(m,{label:"自定义流程状态",prop:"flowStatus"},{default:l(()=>[a(h,{modelValue:t(V),"onUpdate:modelValue":e[5]||(e[5]=o=>N(V)?V.value=o:null)},null,8,["modelValue"])]),_:1}),a(P,{class:"item",effect:"dark",content:"warm-flow工作流默认内置了一套流程状态，如果此字段填写可以自定义流程状态"},{default:l(()=>[a(K,{size:14,class:"ml5 mt10"},{default:l(()=>[a(J)]),_:1})]),_:1})]),_:1}),a(y,null,{default:l(()=>[a(v,{span:12},{default:l(()=>[t(I)?(u(),r(m,{key:0,label:"跳转节点",prop:"showAnyNode"},{default:l(()=>[a(U,{modelValue:t(k),"onUpdate:modelValue":e[6]||(e[6]=o=>N(k)?k.value=o:null),placeholder:"请选择跳转节点"},{default:l(()=>[(u(!0),i(R,null,Y(t(F),o=>(u(),r(L,{key:o.nodeCode,label:o.nodeName,value:o.nodeCode},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):x("",!0)]),_:1})]),_:1}),a(G),t(w)?(u(),r(m,{key:0,label:"审批意见",prop:"message"},{default:l(()=>[a(h,{modelValue:t(n).message,"onUpdate:modelValue":e[7]||(e[7]=o=>t(n).message=o),type:"textarea",placeholder:"请输入审批意见",autosize:{minRows:4,maxRows:4}},null,8,["modelValue"])]),_:1})):x("",!0)]),_:1},8,["model","rules","disabled"])]),_:2},[t(w)?{name:"footer",fn:l(()=>[ne("div",ce,[a(T,{type:"primary",onClick:e[8]||(e[8]=o=>O("PASS"))},{default:l(()=>[C("审批通过")]),_:1}),a(T,{onClick:e[9]||(e[9]=o=>O("REJECT"))},{default:l(()=>[C("退回")]),_:1}),a(T,{onClick:M},{default:l(()=>[C("关 闭")]),_:1})])]),key:"0"}:void 0]),1032,["title","modelValue"])):x("",!0)])}}});export{be as default};
