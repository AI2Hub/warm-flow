import{r as _,C as ie,J as me,d,G as K,o as s,c as $,H as g,I as ce,h as a,e,f as l,k as fe,K as L,L as A,l as h,p as i,D as Q,m as O,z as j,n as R,B as _e,v as he,F as ve}from"./index-CHQH9-TC.js";import{l as z,a as be,g as ge,u as ye,b as Ve,d as ke}from"./dept-4ZYqBaUv.js";const we={class:"app-container"},Ie={class:"dialog-footer"},Ne=_e({name:"Dept"}),Ue=Object.assign(Ne,{setup(Ce){const{proxy:r}=he(),{sys_normal_disable:I}=r.useDict("sys_normal_disable"),q=_([]),f=_(!1),N=_(!0),k=_(!0),C=_(""),x=_([]),D=_(!0),U=_(!0),G=ie({form:{},queryParams:{deptName:void 0,status:void 0},rules:{parentId:[{required:!0,message:"上级部门不能为空",trigger:"blur"}],deptName:[{required:!0,message:"部门名称不能为空",trigger:"blur"}],orderNum:[{required:!0,message:"显示排序不能为空",trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],phone:[{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}]}}),{queryParams:v,form:o,rules:H}=me(G);function b(){N.value=!0,z(v.value).then(u=>{q.value=r.handleTree(u.data,"deptId"),N.value=!1})}function J(){f.value=!1,S()}function S(){o.value={deptId:void 0,parentId:void 0,deptName:void 0,orderNum:0,leader:void 0,phone:void 0,email:void 0,status:"0"},r.resetForm("deptRef")}function T(){b()}function M(){r.resetForm("queryRef"),T()}function P(u){S(),z().then(n=>{x.value=r.handleTree(n.data,"deptId")}),u!=null&&(o.value.parentId=u.deptId),f.value=!0,C.value="添加部门"}function W(){U.value=!1,D.value=!D.value,ve(()=>{U.value=!0})}function X(u){S(),be(u.deptId).then(n=>{x.value=r.handleTree(n.data,"deptId")}),ge(u.deptId).then(n=>{o.value=n.data,f.value=!0,C.value="修改部门"})}function Y(){r.$refs.deptRef.validate(u=>{u&&(o.value.deptId!=null?ye(o.value).then(n=>{r.$modal.msgSuccess("修改成功"),f.value=!1,b()}):Ve(o.value).then(n=>{r.$modal.msgSuccess("新增成功"),f.value=!1,b()}))})}function Z(u){r.$modal.confirm('是否确认删除名称为"'+u.deptName+'"的数据项?').then(function(){return ke(u.deptId)}).then(()=>{b(),r.$modal.msgSuccess("删除成功")}).catch(()=>{})}return b(),(u,n)=>{const y=d("el-input"),p=d("el-form-item"),ee=d("el-option"),le=d("el-select"),m=d("el-button"),B=d("el-form"),c=d("el-col"),te=d("right-toolbar"),E=d("el-row"),V=d("el-table-column"),ae=d("dict-tag"),ne=d("el-table"),oe=d("el-tree-select"),de=d("el-input-number"),ue=d("el-radio"),re=d("el-radio-group"),se=d("el-dialog"),w=K("hasPermi"),pe=K("loading");return s(),$("div",we,[g(e(B,{model:a(v),ref:"queryRef",inline:!0},{default:l(()=>[e(p,{label:"部门名称",prop:"deptName"},{default:l(()=>[e(y,{modelValue:a(v).deptName,"onUpdate:modelValue":n[0]||(n[0]=t=>a(v).deptName=t),placeholder:"请输入部门名称",clearable:"",style:{width:"200px"},onKeyup:fe(T,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(p,{label:"状态",prop:"status"},{default:l(()=>[e(le,{modelValue:a(v).status,"onUpdate:modelValue":n[1]||(n[1]=t=>a(v).status=t),placeholder:"部门状态",clearable:"",style:{width:"200px"}},{default:l(()=>[(s(!0),$(L,null,A(a(I),t=>(s(),h(ee,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,null,{default:l(()=>[e(m,{type:"primary",icon:"Search",onClick:T},{default:l(()=>[i("搜索")]),_:1}),e(m,{icon:"Refresh",onClick:M},{default:l(()=>[i("重置")]),_:1})]),_:1})]),_:1},8,["model"]),[[ce,a(k)]]),e(E,{gutter:10,class:"mb8"},{default:l(()=>[e(c,{span:1.5},{default:l(()=>[g((s(),h(m,{type:"primary",plain:"",icon:"Plus",onClick:P},{default:l(()=>[i("新增")]),_:1})),[[w,["system:dept:add"]]])]),_:1}),e(c,{span:1.5},{default:l(()=>[e(m,{type:"info",plain:"",icon:"Sort",onClick:W},{default:l(()=>[i("展开/折叠")]),_:1})]),_:1}),e(te,{showSearch:a(k),"onUpdate:showSearch":n[2]||(n[2]=t=>Q(k)?k.value=t:null),onQueryTable:b},null,8,["showSearch"])]),_:1}),a(U)?g((s(),h(ne,{key:0,data:a(q),"row-key":"deptId","default-expand-all":a(D),"tree-props":{children:"children",hasChildren:"hasChildren"}},{default:l(()=>[e(V,{prop:"deptName",label:"部门名称",width:"260"}),e(V,{prop:"orderNum",label:"排序",width:"200"}),e(V,{prop:"status",label:"状态",width:"100"},{default:l(t=>[e(ae,{options:a(I),value:t.row.status},null,8,["options","value"])]),_:1}),e(V,{label:"创建时间",align:"center",prop:"createTime",width:"200"},{default:l(t=>[O("span",null,j(u.parseTime(t.row.createTime)),1)]),_:1}),e(V,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:l(t=>[g((s(),h(m,{link:"",type:"primary",icon:"Edit",onClick:F=>X(t.row)},{default:l(()=>[i("修改")]),_:2},1032,["onClick"])),[[w,["system:dept:edit"]]]),g((s(),h(m,{link:"",type:"primary",icon:"Plus",onClick:F=>P(t.row)},{default:l(()=>[i("新增")]),_:2},1032,["onClick"])),[[w,["system:dept:add"]]]),t.row.parentId!=0?g((s(),h(m,{key:0,link:"",type:"primary",icon:"Delete",onClick:F=>Z(t.row)},{default:l(()=>[i("删除")]),_:2},1032,["onClick"])),[[w,["system:dept:remove"]]]):R("",!0)]),_:1})]),_:1},8,["data","default-expand-all"])),[[pe,a(N)]]):R("",!0),e(se,{title:a(C),modelValue:a(f),"onUpdate:modelValue":n[10]||(n[10]=t=>Q(f)?f.value=t:null),width:"600px","append-to-body":""},{footer:l(()=>[O("div",Ie,[e(m,{type:"primary",onClick:Y},{default:l(()=>[i("确 定")]),_:1}),e(m,{onClick:J},{default:l(()=>[i("取 消")]),_:1})])]),default:l(()=>[e(B,{ref:"deptRef",model:a(o),rules:a(H),"label-width":"80px"},{default:l(()=>[e(E,null,{default:l(()=>[a(o).parentId!==0?(s(),h(c,{key:0,span:24},{default:l(()=>[e(p,{label:"上级部门",prop:"parentId"},{default:l(()=>[e(oe,{modelValue:a(o).parentId,"onUpdate:modelValue":n[3]||(n[3]=t=>a(o).parentId=t),data:a(x),props:{value:"deptId",label:"deptName",children:"children"},"value-key":"deptId",placeholder:"选择上级部门","check-strictly":""},null,8,["modelValue","data"])]),_:1})]),_:1})):R("",!0),e(c,{span:12},{default:l(()=>[e(p,{label:"部门名称",prop:"deptName"},{default:l(()=>[e(y,{modelValue:a(o).deptName,"onUpdate:modelValue":n[4]||(n[4]=t=>a(o).deptName=t),placeholder:"请输入部门名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:l(()=>[e(p,{label:"显示排序",prop:"orderNum"},{default:l(()=>[e(de,{modelValue:a(o).orderNum,"onUpdate:modelValue":n[5]||(n[5]=t=>a(o).orderNum=t),"controls-position":"right",min:0},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:l(()=>[e(p,{label:"负责人",prop:"leader"},{default:l(()=>[e(y,{modelValue:a(o).leader,"onUpdate:modelValue":n[6]||(n[6]=t=>a(o).leader=t),placeholder:"请输入负责人",maxlength:"20"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:l(()=>[e(p,{label:"联系电话",prop:"phone"},{default:l(()=>[e(y,{modelValue:a(o).phone,"onUpdate:modelValue":n[7]||(n[7]=t=>a(o).phone=t),placeholder:"请输入联系电话",maxlength:"11"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:l(()=>[e(p,{label:"邮箱",prop:"email"},{default:l(()=>[e(y,{modelValue:a(o).email,"onUpdate:modelValue":n[8]||(n[8]=t=>a(o).email=t),placeholder:"请输入邮箱",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:l(()=>[e(p,{label:"部门状态"},{default:l(()=>[e(re,{modelValue:a(o).status,"onUpdate:modelValue":n[9]||(n[9]=t=>a(o).status=t)},{default:l(()=>[(s(!0),$(L,null,A(a(I),t=>(s(),h(ue,{key:t.value,label:t.value},{default:l(()=>[i(j(t.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{Ue as default};
